# Mishpokhe uses a clustering algorithm inspired by Rodriguez and Laio, 2014 (https://www.science.org/doi/10.1126/science.1242072). However, few changes were made in order to better serve our data and purposes. 

First, centroids are found using density*distance threshold. This distance is a minimum distance to the higher density point. In the paper, it is strictly higher, while in our case it is higher or equal (because some clusters can have 2 and more points that could in theory be centroids, they have the same density, and if we simply say strictly higher, they all get to be centroids, because their minimum distance would be to something else, not another “potential centroid”. Here it is achieved by checking for the points with the same density if they are inside the distance cutoff for the density calculation. As the list of densities is sorted and ordered, the points with the same density laying in the radius of distance cutoff, would get assigned to the last of these points in the list, which is a centroid.

Second, instead of making a route from lower to higher density point to assign points to the centroid, we take simply the closest centroid to the point. We expect our clusters to look as concentric spheres, rather than some irregular shape. Route by density causes clusters to mix and absorb some non-relevant non-overlapped with the centroids/members points.

Third, we have a different treatment for the “noise” points. As we don't assign points to the centroids by the density route, we do not need density thresholds. It implicitly exists already. So our noise points are basically those which have a very-very low density, but very far away from any centroid. Example can be a single point having a density = 0, but a distance to any other centroid = 1 (maximum). It does not become a centroid in the process using ing density*distance threshold simply because it is too high for the point, the point density*distance = 0. In the case of the higher density the points belonging to this noise point would be assigned to the centroids closest to them. Is it optimal? Maybe not, but that is how it is now. I do not want to make it more complicated at the moment. So basically we set up the threshold to remove such points from the assignment procedure and make them to become centroids. The distance threshold (min dist to higher) = 1. Lower threshold does not make sense: if the point density > 0, then it would make out of these noisy few points all different centroids. With the distance threshold = 1, it would only be the “centroid” which is really far from other points. However, if all the points in this “noisy” cluster have a distance from other centroids = 1, then they all become centroids? Well, I don't think it is a problem. Current density*distance threshold = 2. That basically means that at minimum it should be dens = 4 and dist = 0.51 or dens = 2 and dist = 1. As long as the distance < 1, it is not such a bad thing to assign these noisy points to the cluster they are a bit similar to. When the distance is 1, practically it can be only 1 point which did not become a centroid. 

The distance metric currently used: dist = 1 - (min((align_part/len_vec0), (align_part/len_vec1))) -> 36 clusters
Possible alternative: dist = 1 - (max((align_part/len_vec0), (align_part/len_vec1))) -> 27 clusters
To be used: dist = 1 - (align_part/(len_vec0*len_vec1)^-2) -> 56 clusters
