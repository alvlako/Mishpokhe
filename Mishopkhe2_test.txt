The same test (query_prot_db, test_prot_db).
The results file is called py2_res

it has revealed that to match the number of proteins
in target (test_prot_db) database I have to grep only CDS
from prodigal gff (target_test1_prodigal.gff)


I also made multihitdb for target database to know
the coordinates and strand (just like in previous test file)
mmseqs multihitdb *.fasta_lin target_test.gff.txt test_multihit_db tmp

Seems like mmseqs search works fine with the multihitdb as well
mmseqs search query_prot_db_clu_rep_profile test_multihit_db py2_multihit_res tmp -a

CHECK why there are more results with multihitdb (target is converted to profiles??)

It seems like I should include gene gap penalty for 
clustersearch mishopkhe algorithm (Algorithm 1) - 
ask Johannes

I do not get what scores are used in the 1st algorithm and 
how they are linked to others. At what moment do we set the
scores and the flip penalty?

CHANGE scores in find_clusters() to log enrichment score

# MAKE it to an automatic step
# CHECK if it should be _clu_rep_profile
mmseqs convertalis query_prot_db_clu_rep_profile test_multihit_db 
 py2_multihit_res py2_multihit_res.m8

# FIX !!!!!!! the problem (?) with the target proteins ids.
-- I found the problem cause. In normal db_h the 1st filed is the
prot id, while in multihit_db_h it is some other ID (0). I have
to fix it. Maybe CHANGE back to normal db?
# Does multihitdb actually work in normal search. I can just take
coordinates and strand from normal db_h
MT006214.1_66 # 74390 # 75166 # -1 #
# FIX !!! to iteration through target prots in find_cluster()

# FIX, THINK, ASK about gene gap in 1st iteration of the algorithm1
I dont see how it makes clusters, without just combining everything in
one cluster. Should i just filter different genomes?